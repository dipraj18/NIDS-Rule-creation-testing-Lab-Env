# ===============================
# Local Security Rules (Snort 3)
# ===============================

# 1. SSH Brute Force
alert tcp any any -> $HOME_NET 22 (
    msg:"SSH Brute-Force Attempt Detected";
    flow:to_server,established;
    detection_filter:track by_src, count 5, seconds 60;
    sid:1000001; rev:1;
)

# 2. HTTP Brute Force/Login Attempts
alert tcp any any -> $HOME_NET 80 (
    msg:"HTTP Brute Force/Login Attempts";
    flow:to_server,established;
    content:"login";
    detection_filter:track by_src, count 10, seconds 60;
    sid:1000002; rev:1;
)

# 3. SQL Injection Attempt
alert tcp any any -> $HOME_NET 80 (
    msg:"SQL Injection Attempt Detected";
    flow:to_server,established;
    content:"' OR '1'='1";
    sid:1000003; rev:1;
)

# 4. SMB Exploit (EternalBlue-like)
alert tcp any any -> $HOME_NET 445 (
    msg:"SMB Exploit Attempt (EternalBlue)";
    flow:to_server,established;
    content:"|00 00 00 90 FF 53 4D 42|";
    sid:1000004; rev:1;
)

# 5. ICMP Ping Sweep
alert icmp any any -> $HOME_NET any (
    msg:"ICMP Ping Sweep Detected";
    detection_filter:track by_src, count 5, seconds 10;
    sid:1000005; rev:1;
)

# 6. Nmap TCP SYN Scan
alert tcp any any -> $HOME_NET any (
    msg:"Nmap TCP SYN Scan Detected";
    flags:S;
    flow:stateless;
    sid:1000006; rev:1;
)
 
# 7. RDP Brute Force (Port 3389)
alert tcp any any -> $HOME_NET 3389 (
    msg:"RDP Brute Force Attempt Detected";
    flow:to_server,established;
    detection_filter:track by_src, count 5, seconds 60;
    sid:1000007; rev:1;
)

# 8. FTP Brute Force
alert tcp any any -> $HOME_NET 21 (
    msg:"FTP Brute Force Attempt Detected";
    flow:to_server,established;
    detection_filter:track by_src, count 5, seconds 60;
    sid:1000008; rev:1;
)

# 9. DNS Tunneling Suspicious Query
alert udp any any -> $HOME_NET 53 (
    msg:"Possible DNS Tunneling Detected";
    content:".";
    sid:1000009; rev:1;
)

# 10. DoS - SYN Flood Detection
alert tcp any any -> $HOME_NET any (
    msg:"Potential SYN Flood Detected";
    flags:S;
    flow:stateless;
    detection_filter:track by_src, count 100, seconds 10;
    sid:1000010; rev:1;
)

# 11. Generic Port Scan
alert ip any any -> $HOME_NET any (
    msg:"Possible Port Scan";
    detection_filter:track by_src, count 15, seconds 30;
    sid:1000011; rev:1;
)
 
# 12. Buffer Overflow - NOP sled
alert ip any any -> $HOME_NET any (
    msg:"Buffer Overflow Attempt - NOP Sled Detected";
    content:"|90 90 90 90 90 90 90 90|";
    sid:1000012; rev:1;
)